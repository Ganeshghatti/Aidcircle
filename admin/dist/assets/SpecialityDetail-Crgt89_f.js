import{r as n,k as P,j as e,l as N,o as I,s as T}from"./index-DVbhMGLa.js";import{R as k}from"./quill.snow-CalU3Sp8.js";import{I as D,E as U}from"./InputText-BLskhWZc.js";import{l as d,u as F}from"./Layout-Dsp69F2b.js";function C({id:b,label:m,value:f,setValue:v}){const y=n.useRef(),{link:S}=P(),u=localStorage.getItem("token"),[E,g]=n.useState(!1),t=h=>{const o=y.current.getEditor(),c=document.createElement("input");c.setAttribute("type","file"),c.setAttribute("accept","image/*"),c.click(),c.onchange=async()=>{const x=c.files[0];if(/^image\//.test(x.type)){console.log(x);const j=new FormData;j.append("image",x),g(!0);try{const i=(await N.post(`http://localhost:5000/admin/upload-speciality-image/${S}`,j,{headers:{Authorization:`Bearer ${u}`,"Content-Type":"multipart/form-data"}})).data.specialityImageUrl,l=o.getSelection();o.insertEmbed(l.index,"image",i),o.setSelection(l.index+1),o.insertText(l.index+1,`
`),d.NotificationManager.success("Success","Image Uploaded Successfully")}catch(a){console.log(a),d.NotificationManager.error("Error","Failed to update campaign",5e3,()=>{alert(a.response.data.error)})}finally{g(!1)}}}},r=["header","height","bold","italic","underline","strike","blockquote","list","color","bullet","indent","link","image","align","size"],w=n.useMemo(()=>({toolbar:{container:[[{size:["small",!1,"large","huge"]}],["bold","italic","underline","strike","blockquote"],[{list:"ordered"},{list:"bullet"}],["link","image"],[{list:"ordered"},{list:"bullet"},{indent:"-1"},{indent:"+1"},{align:[]}],[{color:["#000000","#e60000","#ff9900","#ffff00","#008a00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466","custom-color"]}]],handlers:{image:t}}}),[]);return e.jsx(e.Fragment,{children:e.jsx(k,{theme:"snow",ref:y,value:f,modules:w,onChange:h=>v(h),formats:r})})}function M(){const b=I(),{link:m}=P(),f=localStorage.getItem("token"),[v,y]=n.useState([]),[S,u]=n.useState(!1),[E,g]=n.useState(""),[t,r]=n.useState({title:"",desc:"",icon:null,iconPreview:"",wallpaperimg:null,wallpaperimgPreview:""}),w=a=>{const i=document.createElement("div");i.innerHTML=a;const l=i.getElementsByTagName("img"),s=[];for(let p of l)s.push(p.src);return s},h=async()=>{try{if(f&&m){u(!0);const a=await N.get(`http://localhost:5000/admin/get-speciality-details/${m}`,{headers:{Authorization:`Bearer ${f}`}}),i=a.data.speciality;console.log(a.data.speciality),r(s=>({...s,title:i.title,desc:i.desc,content:i.content,iconPreview:i.icon,wallpaperimgPreview:i.wallpaperimg}));const l=w(i.content);y(l)}}catch(a){if(console.log(a),a.response&&a.response.status===401)return b("/");d.NotificationManager.error("Failed to fetch Specialities","Error",5e3,()=>{alert(a.response.data.error)})}finally{u(!1)}};n.useEffect(()=>{h()},[f]);const o=({updateType:a,value:i})=>{r({...t,[a]:i})},c=a=>{const i=a.target.files[0];r(l=>({...l,icon:i,iconPreview:URL.createObjectURL(i)}))},x=a=>{const i=a.target.files[0];r(l=>({...l,wallpaperimg:i,wallpaperimgPreview:URL.createObjectURL(i)}))},j=async a=>{if(a.preventDefault(),g(""),!t.title||!t.desc||!t.iconPreview||!t.wallpaperimgPreview){g("All fields are required."),d.NotificationManager.error("Error","All fields are required.");return}const i=w(t.content),l=v.filter(p=>!i.includes(p)),s=new FormData;s.append("title",t.title),s.append("desc",t.desc),s.append("content",t.content),t.icon&&s.append("icon",t.icon),t.wallpaperimg&&s.append("wallpaperimg",t.wallpaperimg),l&&s.append("imagesToDelete",JSON.stringify(l));try{u(!0);const p=await N.put(`http://localhost:5000/admin/update-speciality-details/${m}`,s,{headers:{Authorization:`Bearer ${f}`,"Content-Type":"multipart/form-data"}});d.NotificationManager.success("Success","Speciality Updated Successfully"),h()}catch(p){g(p.response.data.error),d.NotificationManager.error("Error","Failed to update Speciality",5e3,()=>{alert(p.response.data.error)})}finally{u(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(d.NotificationContainer,{}),t&&t.title&&e.jsxs("div",{className:"w-full flex flex-col gap-8",children:[e.jsx(D,{type:"text",defaultValue:t.title,updateType:"title",containerStyle:"mt-4",labelTitle:"Enter Speciality Title",updateFormValue:o}),e.jsx(D,{type:"text",defaultValue:t.desc,updateType:"desc",labelTitle:"Enter Description",updateFormValue:o}),e.jsxs("div",{className:"form-control flex flex-col gap-2",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Upload Icon"})})," ",e.jsx("input",{type:"file",accept:"image/*,image/svg+xml",onChange:c,className:"input input-bordered w-full"})," ",t.iconPreview&&e.jsx("div",{children:e.jsx("img",{src:t.iconPreview,alt:"Icon Preview",className:"w-1/5 h-auto mt-4"})})]}),e.jsxs("div",{className:"form-control flex flex-col gap-2",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Upload Wall Paper Image"})})," ",e.jsx("input",{type:"file",accept:"image/*,image/svg+xml",onChange:x,className:"input input-bordered w-full"})," ",t.wallpaperimgPreview&&e.jsx("div",{children:e.jsx("img",{src:t.wallpaperimgPreview,alt:"WallPaper Preview",className:"w-1/5 h-auto mt-4"})})]}),e.jsx(C,{id:"description",name:"description",label:"Description",value:t.content,setValue:a=>r(i=>({...i,content:a}))}),e.jsx(U,{styleClass:"mt-8",children:E}),e.jsx("button",{type:"submit",onClick:j,className:"btn mt-2 w-full btn-primary"+(S?" loading":""),children:"Update"})]})]})}function q(){const{link:b}=P(),m=F();return n.useEffect(()=>{m(T({title:b}))},[]),e.jsx(M,{})}export{q as default};
