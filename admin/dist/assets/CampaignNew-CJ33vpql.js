import{o as j,r as i,j as a,l as y,s as v}from"./index-Bf73z5r4.js";import"./quill.snow-wHLeYI4R.js";import{I as p,E as C}from"./InputText-CYls1_pt.js";import{l as o,u as P}from"./Layout-HwrZM4zP.js";function T(){const c=j(),[e,r]=i.useState({title:"",status:"private",amount:"",beneficiaryName:"",thumbnail:null,thumbnailPreview:"",carouselImages:[],carouselPreviews:[]}),[d,f]=i.useState(!1),[g,u]=i.useState(""),m=({updateType:s,value:t})=>{r({...e,[s]:t})},h=()=>{r(s=>({...s,status:s.status==="private"?"public":"private"}))},x=s=>{r(t=>({...t,amount:s}))},b=s=>{const t=s.target.files[0];r(l=>({...l,thumbnail:t,thumbnailPreview:URL.createObjectURL(t)}))},N=s=>{const t=Array.from(s.target.files),l=t.map(n=>URL.createObjectURL(n));r(n=>({...n,carouselImages:[...n.carouselImages,...t],carouselPreviews:[...n.carouselPreviews,...l]}))},w=async s=>{if(s.preventDefault(),u(""),!e.title||!e.status||!e.amount||!e.beneficiaryName||!e.thumbnail||e.carouselImages.length===0){u("All fields are required."),o.NotificationManager.error("Error","All fields are required.");return}const t=new FormData;t.append("title",e.title),t.append("status",e.status),t.append("amount",e.amount),t.append("beneficiaryName",e.beneficiaryName),e.thumbnail&&t.append("thumbnail",e.thumbnail);for(let l=0;l<e.carouselImages.length;l++)t.append("carouselImages",e.carouselImages[l]);try{const l=await y.post("http://localhost:5000/admin/campaign-new",t,{headers:{"Content-Type":"multipart/form-data"}});o.NotificationManager.success("Success","Created new Campaign Successfully"),c("/app/campaigns")}catch(l){u(l.response.data.error),o.NotificationManager.error("Error","Failed to create new campaign",5e3,()=>{alert(l.response.data.error)})}finally{f(!1)}};return i.useEffect(()=>{console.log(e)},[e]),a.jsxs(a.Fragment,{children:[a.jsx(o.NotificationContainer,{}),a.jsxs("div",{className:"w-full flex flex-col gap-8",children:[a.jsx(p,{type:"text",defaultValue:e.title,updateType:"title",containerStyle:"mt-4",labelTitle:"Enter Campaign Title",updateFormValue:m}),a.jsx(p,{type:"text",defaultValue:e.beneficiaryName,updateType:"beneficiaryName",labelTitle:"Enter Beneficiary Name",updateFormValue:m}),a.jsxs("label",{className:"label cursor-pointer flex justify-start gap-4 w-fit",children:[a.jsxs("span",{className:"label-text text-base-content",children:["Status: ",e.status]}),a.jsx("input",{type:"checkbox",className:"toggle",checked:e.status==="public",onChange:h})]}),a.jsx("input",{type:"number",value:e.amount,placeholder:"Enter Campaign Amount",onChange:s=>x(s.target.value),className:"input input-bordered w-full",style:{appearance:"textfield",MozAppearance:"textfield",MsAppearance:"textfield"}}),a.jsxs("div",{className:"form-control flex flex-col gap-2",children:[a.jsx("label",{className:"label",children:a.jsx("span",{className:"label-text",children:"Upload Thumbnail Image"})})," ",a.jsx("input",{type:"file",accept:"image/*",onChange:b,className:"input input-bordered w-full"})," ",e.thumbnailPreview&&a.jsx("div",{children:a.jsx("img",{src:e.thumbnailPreview,alt:"Thumbnail Preview",className:"w-1/5 h-auto mt-4"})})]}),a.jsxs("div",{className:"form-control flex flex-col gap-2",children:[a.jsx("label",{className:"label",children:a.jsx("span",{className:"label-text",children:"Upload Carousel Images (1-5)"})})," ",a.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:N,className:"input input-bordered w-1/5"}),e.carouselPreviews&&e.carouselPreviews.length>0&&a.jsx("div",{className:"w-full mt-4 flex flex-wrap gap-2",children:e.carouselPreviews.map((s,t)=>a.jsx("img",{src:s,alt:`Carousel Preview ${t+1}`,className:"w-1/5 h-auto"},t))})]}),a.jsx(C,{styleClass:"mt-8",children:g}),a.jsx("button",{type:"submit",onClick:w,className:"btn mt-2 w-full btn-primary"+(d?" loading":""),children:"Create New!"})]})]})}function M(){const c=P();return i.useEffect(()=>{c(v({title:"New Campaigns"}))},[]),a.jsx(T,{})}export{M as default};
